# /etc/ddos-guard/ddos-guard.conf
# DDoS Guard Configuration File

# Number of SYN-RECV connections from a subnet to trigger blocking
THRESHOLD=10

# Seconds between detection scans
CHECK_INTERVAL=30

# Subnet mask to block (24 = /24, 16 = /16, etc.)
SUBNET_MASK=24

# Ports to monitor (space-separated)
PORTS="443"

# Enable IPv4 detection
ENABLE_IPV4=true

# Enable IPv6 detection
ENABLE_IPV6=false

# Auto-unblock after X hours (0 = never unblock)
AUTO_UNBLOCK_HOURS=0

# Save iptables rules persistently
SAVE_IPTABLES=true

#
# Advanced Detection Options (helps reduce false positives)
#

# Detection mode: "count", "age", or "rate"
# - count: Block if current SYN-RECV count exceeds threshold
# - age: Only count SYN-RECV connections older than MIN_CONNECTION_AGE seconds
# - rate: Block if new connections per time window exceed threshold
DETECTION_MODE="age"

# Minimum connection age in seconds (for age mode)
# Only count SYN-RECV connections that have been stuck for this long
# Legitimate connections complete in <1 second, attacks persist longer
# Recommended: 3-5 seconds
MIN_CONNECTION_AGE=3

# Rate tracking window in seconds (for rate mode)
# Track connection rate over this time period
# Recommended: 60-300 seconds
RATE_WINDOW=60

# Per-IP rate limit (connections per minute, 0 = disabled)
# Block individual IPs exceeding this rate regardless of subnet aggregation
# Helps catch single-source attacks before they reach subnet threshold
# Recommended: 20-50 for most sites
PER_IP_RATE_LIMIT=30

